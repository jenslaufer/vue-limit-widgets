(function(c,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(c=typeof globalThis<"u"?globalThis:c||self,n(c.VueLimitWidgets={},c.Vue))})(this,(function(c,n){"use strict";const f=()=>typeof chrome>"u"?null:chrome.storage?.local??null,w=()=>{if(typeof globalThis>"u")return null;try{const t=globalThis.localStorage;return!t||typeof t.getItem!="function"?null:t}catch{return null}},g=async t=>{const e=f();if(e)return(await e.get(t))[t]??null;const r=w();if(r){const a=r.getItem(t);if(a===null)return null;try{return JSON.parse(a)}catch{return null}}throw new Error("No supported storage backend available")},p=async(t,e)=>{const r=f();if(r){await r.set({[t]:e});return}const a=w();if(a){a.setItem(t,JSON.stringify(e));return}throw new Error("No supported storage backend available")},d="n8eneere88chbpbp8766bc97",m=t=>btoa(String.fromCodePoint(...new TextEncoder().encode(JSON.stringify(t)).map((e,r)=>e^d.codePointAt(r%d.length)))),x=t=>{try{const e=new Uint8Array(atob(t).split("").map((r,a)=>r.codePointAt(0)^d.codePointAt(a%d.length)));return JSON.parse(new TextDecoder().decode(e))}catch(e){return console.warn("Failed to decrypt data:",e.message),null}},y=new Map,S=async(t,e)=>{const r=y.get(t)??Promise.resolve();let a;const s=new Promise(u=>{a=u});y.set(t,r.then(()=>s)),await r;try{return await e()}finally{a(),y.get(t)===s&&y.delete(t)}},b=async t=>{const e=await g(t);return e?x(e):null},N=async(t,e)=>{const r=m(e);return p(t,r)},k=async(t,e)=>S(t,async()=>{const r=Number(await b(t)??0),a=Number(e),s=r<=a?r+1:r;return await N(t,s),s}),E=async t=>{const e=await g(t);return e?x(e):null},h=async(t,e)=>{const r=m(e);return p(t,r)},M={__name:"Quota",props:{quotaName:{type:String,default:"quota"},maxQuotaName:{type:String,default:"maxQuota"},maxQuota:{type:Number,required:!0}},setup(t){const e=t,r=n.ref(0),a=n.ref(0),s=n.ref(!1),u=async o=>{const l=await E(o),Q=Number(l??e.maxQuota);l===null&&await h(o,Q),a.value=Q},i=async o=>{r.value=await k(o,a.value)};return n.watch(()=>e.maxQuota,async o=>{const l=Number(o);a.value=l,await h(e.maxQuotaName,l)}),n.watch(()=>e.maxQuotaName,async o=>{await u(o)}),n.watch(()=>e.quotaName,async o=>{await i(o)}),n.onMounted(async()=>{await u(e.maxQuotaName),await i(e.quotaName),s.value=!0}),(o,l)=>s.value?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[r.value<=a.value?n.renderSlot(o.$slots,"withinQuota",{key:0}):n.renderSlot(o.$slots,"exceededQuota",{key:1})],64)):n.createCommentVNode("",!0)}},U=async(t,e)=>{const r=m(e);return p(t,r)},_={__name:"Expiry",props:{expiry:{type:String,required:!0},expiryName:{type:String,default:"expiry"}},setup(t){const e=t,r=n.ref(new Date),a=n.ref(new Date),s=n.ref(!1);let u=null;return n.watch(()=>[e.expiry,e.expiryName],async([i,o])=>{r.value=new Date(i),await U(o,i)},{immediate:!0}),n.onMounted(()=>{a.value=new Date,s.value=!0,u=setInterval(()=>{a.value=new Date},6e4)}),n.onUnmounted(()=>{clearInterval(u)}),(i,o)=>s.value?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[a.value<=r.value?n.renderSlot(i.$slots,"withinExpiry",{key:0}):n.renderSlot(i.$slots,"exceededExpiry",{key:1})],64)):n.createCommentVNode("",!0)}};c.Expiry=_,c.Quota=M,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));
